동시성 문제가 발생하는 근본적인 원인은 여러 스레드가 함께 사용하는 공유 자원을 여러 단계로 나누어 사용하기 때문이다.

1. 검증 단계
2. 출금 단계

이 로직에는 하나의 큰 가정이 있다.
*검증 단계 - 출금 단계에서 사용하는 값이 중간에 변경되지 않을 것이라는 가정*
스레드 하나의 관점에서 `withdraw()`  를 보면 1. 검증 단계에서 확인한 잔액 1000원은 2. 출금 단계에서 계산을 끝마칠 때 까지 같은 1000원으로 유지되어야 한다.
그래야 검증 단계에서 확인한 금액으로 출금 단계에서 정확한 잔액을 계산할 수 있다.

###### 공유 자원
잔액(`balance`)은 여러 스레드가 함께 사용하는 공유 자원이다. 따라서 출금 로직을 수행하는 중간에 다른 스레드에서 이 값이 얼마든지 변경될 수 있다.

이러한 문제를 해결하기 위해  공유 자원을 사용하는 부분에서는 **한 번에 하나의 스레드만 실행**하도록 하여 문제를 해결할 수 있다.

###### 임계 영역

- 여러 스레드가 동시에 접근하면 데이터 불일치나 예상치 못한 동작이 발생할 수 있는 위험하고 중요한 코드 부분
- 여러 스레드가 동시에 저븐해서는 안되는 공유 자원을 접근하거나 수정하는 부분

자바에서는 `synchronized` 키워드를 통해 임계 영역에 한 번에 하나의 스레드만 접근할 수 있도로 할 수 있다.
